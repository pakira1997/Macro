Sub RearrangeCol5_ByBlockOf17_Continuous()
    Dim filePath As String
    Dim outputFile As String
    Dim fIn As Integer, fOut As Integer
    Dim lineData As String
    Dim fields() As String
    Dim buf(1 To 17) As String
    Dim cnt As Long
    Dim i As Long
    
    '=== ファイルパスを適宜変更 ===
    filePath = "C:\test\data.csv"
    outputFile = "C:\test\rearranged.txt"
    '=============================
    
    fIn = FreeFile
    Open filePath For Input As #fIn
    
    fOut = FreeFile
    Open outputFile For Output As #fOut
    
    cnt = 0
    Do Until EOF(fIn)
        Line Input #fIn, lineData
        fields = Split(lineData, ",")
        
        If UBound(fields) >= 4 Then
            cnt = cnt + 1
            buf(cnt) = fields(4)
            
            ' 17件溜まったら17→1の順で1行に連結出力
            If cnt = 17 Then
                Dim lineOut As String
                lineOut = ""
                For i = 17 To 1 Step -1
                    lineOut = lineOut & buf(i)
                Next i
                Print #fOut, lineOut
                cnt = 0
            End If
        End If
    Loop
    
    ' 端数がある場合も出力
    If cnt > 0 Then
        Dim lastOut As String
        lastOut = ""
        For i = cnt To 1 Step -1
            lastOut = lastOut & buf(i)
        Next i
        Print #fOut, lastOut
    End If
    
    Close #fIn
    Close #fOut
    
    MsgBox "出力完了: " & outputFile
End Sub
